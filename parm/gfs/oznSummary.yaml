#
#  Summary plots for OznMon gfs
# 
#    Make 4 plots:
#      - Obs counts from last 4 cycles
#      - Avg and sdv omgbc for 1 day, 7 days,  and 30 days
#      - Avg and sdv penalty for 1 day, 1 day, and 30 days


# Data read
# ---------
datasets:
  - name: summary
    satellite: {{SAT}}
    sensor: {{SENSOR}}
    type: MonDataSpace
    control_file:
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.ctl
    filenames:
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATE | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm6 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm12 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm18 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm24 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm30 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm36 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm42 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm48 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm54 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm60 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm66 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm72 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm78 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm84 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm90 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm96 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm102 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm108 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm114 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm120 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm126 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm132 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm138 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm144 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm150 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm156 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm162 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm168 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm174 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm180 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm186 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm192 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm198 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm204 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm210 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm216 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm222 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm228 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm234 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm240 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm246 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm252 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm258 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm264 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm270 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm276 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm282 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm288 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm294 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm300 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm306 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm312 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm318 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm324 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm330 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm336 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm342 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm348 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm354 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm360 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm366 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm372 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm378 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm384 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm390 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm396 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm402 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm408 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm414 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm420 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm426 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm432 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm438 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm444 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm450 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm456 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm462 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm468 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm474 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm480 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm486 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm492 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm498 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm504 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm510 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm516 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm522 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm528 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm534 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm540 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm546 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm552 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm558 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm564 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm570 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm576 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm582 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm588 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm594 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm600 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm606 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm612 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm618 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm624 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm630 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm636 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm642 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm648 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm654 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm660 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm666 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm672 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm678 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm684 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm690 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm696 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm702 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm708 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm714 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm720 | to_YMDH }}.ieee_d
      - {{DATA}}/ozn_data/time/{{SENSOR}}_{{SAT}}.{{STEP}}.{{ PDATEm726 | to_YMDH }}.ieee_d

    levels: {{LEVELS}}
    regions: &regions 1
    groups:
      - name: GsiIeee
        variables: ['cnt']

transforms:
  - transform: accept where
    new name: summary::GsiIeee::nassim
    starting field: summary::GsiIeee::level_nassim
    where:
      - summary::GsiIeee::level_nassim > 0
    for:
      variable: [none]

  - transform: accept where
    new name: summary::GsiIeee::assim
    starting field: summary::GsiIeee::level_assim
    where:
      - summary::GsiIeee::level_assim > 0
    for:
      variable: [none]

  - transform: select time
    new name: summary::GsiIeee::count_cyc1
    starting field: summary::GsiIeee::cnt
    cycle: {{ PDATE | to_YMDH }}
    for:
      variable: [none]

  - transform: select time
    new name: summary::GsiIeee::count_cyc2
    starting field: summary::GsiIeee::cnt
    cycle: {{ PDATEm6 | to_YMDH }}
    for:
      variable: [none]

  - transform: select time
    new name: summary::GsiIeee::count_cyc3
    starting field: summary::GsiIeee::cnt
    cycle: {{ PDATEm12 | to_YMDH }}
    for:
      variable: [none]

  - transform: select time
    new name: summary::GsiIeee::count_cyc4
    starting field: summary::GsiIeee::cnt
    cycle: {{ PDATEm18 | to_YMDH }}
    for:
      variable: [none]

  # Single avg obs - {{STEP}}
  - transform: select time
    new name: summary::GsiIeee::avgomg_1
    starting field: summary::GsiIeee::avgomg
    cycle: {{ PDATE | to_YMDH }}
    for:
      variable: [none]

  # Single sdv obs - {{STEP}}
  - transform: select time
    new name: summary::GsiIeee::sdvomg_1
    starting field: summary::GsiIeee::sdvomg
    cycle: {{ PDATE | to_YMDH }}
    for:
      variable: [none]

  # avg obs-{{STEP}}, 1 day
  - transform: select time
    new name: summary::GsiIeee::avgomg_1d
    starting field: summary::GsiIeee::avgomg
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm18 | to_YMDH }}
    for:
      variable: [none]

  # sdv obs-{{STEP}}, 1 day
  - transform: select time
    new name: summary::GsiIeee::sdvomg_1d
    starting field: summary::GsiIeee::sdvomg
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm18 | to_YMDH }}
    for:
      variable: [none]

  # avg obs-{{STEP}}, 30 day
  - transform: select time
    new name: summary::GsiIeee::avgomg_30d
    starting field: summary::GsiIeee::avgomg
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm720 | to_YMDH }}
    for:
      variable: [none]

  # sdv obs-{{STEP}}, 30 day
  - transform: select time
    new name: summary::GsiIeee::sdvomg_30d
    starting field: summary::GsiIeee::sdvomg
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm720 | to_YMDH }}
    for:
      variable: [none]

  # cpen, 1 cycle
  - transform: select time
    new name: summary::GsiIeee::cpen_1c
    starting field: summary::GsiIeee::cpen
    cycle: {{ PDATE | to_YMDH }}
    for:
      variable: [none]

  # cpen, 1 day
  - transform: select time
    new name: summary::GsiIeee::cpen_1d
    starting field: summary::GsiIeee::cpen
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm18 | to_YMDH }}
    for:
      variable: [none]

  # cpen, 30 day
  - transform: select time
    new name: summary::GsiIeee::cpen_30d
    starting field: summary::GsiIeee::cpen
    start cycle: {{ PDATE | to_YMDH }}
    end cycle: {{ PDATEm720 | to_YMDH }}
    for:
      variable: [none]

  - transform: arithmetic
    new name: summary::GsiIeee::yaxis_100
    equals: summary::GsiIeee::level_yaxis_z + 100.0
    for:
      variable: [none]
    
  - transform: arithmetic
    new name: summary::GsiIeee::yaxis_np5
    equals: summary::GsiIeee::level_yaxis_z + -1.5
    for:
      variable: [none]
    
  - transform: arithmetic
    new name: summary::GsiIeee::yaxis_n5
    equals: summary::GsiIeee::level_yaxis_z + -5.0
    for:
      variable: [none]
    
graphics:

  plotting_backend: Emcpy
  figure_list:

    - figure:
        layout: [3,1]
        figure size: [20,18]
        tight layout:
        title: "Summary Plot {{SENSOR}}_{{SAT}} \n Valid: {{ PDATE | to_YMDH }}"
        output name: line_plots/{{SENSOR}}_{{SAT}}/ozn/summary/summary.{{SENSOR}}_{{SAT}}.png
        plot logo:
          which: 'noaa/nws'
          loc: 'upper left'
          subplot_orientation: 'first'
      plots:
        # Obs counts, last 4 cycles
        # -------------------------
        - add_xlabel: 'Level'
          add_ylabel: 'Observation Count'
          add_legend:
            loc: 'upper right'
          set_xticks: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]
          set_yticks: [100, 150, 200, 250, 300, 350, 400]
          add_grid:
            axis: 'both'
            linestyle: 'dotted'
            linewidth: 0.25
            color: 'black'
          add_title: 
            label: "Number of Obs Passing QC \n {{ PDATE | to_YMDH }}"
            loc: 'Left'
          layers:
          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::count_cyc1
            color: 'blue'
            label: '{{ PDATE | to_YMDH }}'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::count_cyc2
            color: 'green'
            label: '{{ PDATEm6 | to_YMDH }}'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::count_cyc3
            color: 'orange'
            label: '{{ PDATEm12 | to_YMDH }}'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::count_cyc4
            color: 'red'
            label: '{{ PDATEm18 | to_YMDH }}'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::assim
            y: 
              variable: summary::GsiIeee::yaxis_100
            color: 'green'
            label: 'level assim'
            linestyle: ''
            marker: 's'
            markersize: '6'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::nassim
            y: 
              variable: summary::GsiIeee::yaxis_100
            color: 'red'
            label: 'chan not assim'
            linestyle: ''
            marker: 's'
            markersize: '6'

        # obs-{{STEP}}, avg and sdv, 1 cycle, 1 day, 30 days
        # --------------------------------------------------
        - add_xlabel: 'Level'
          add_ylabel: 'Obs-{{STEP}}'
          add_legend:
            loc: 'upper left'
          set_xticks: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]
          add_grid:
            axis: 'both'
            linestyle: 'dotted'
            linewidth: 0.25
            color: 'black'
          add_title: 
            label: "Obs-Ges\n {{ PDATE | to_YMDH }}"
            loc: 'Left'
          layers:
          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::avgomg_1
            color: 'blue'
            label: 'avg 1 cycle'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::avgomg_1d
            color: 'green'
            label: 'avg 1 day'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::avgomg_30d
            color: 'purple'
            label: 'avg 30 days'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::sdvomg_1
            color: 'red'
            label: 'sdv 1 cycle'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::sdvomg_1d
            color: 'orange'
            label: 'sdv 1 day'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::sdvomg_30d
            color: 'yellow'
            label: 'sdv 30 day'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::assim
            y: 
              variable: summary::GsiIeee::yaxis_n5
            color: 'green'
            label: 'chan assim'
            linestyle: ''
            marker: 's'
            markersize: '6'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::nassim
            y: 
              variable: summary::GsiIeee::yaxis_n5
            color: 'red'
            label: 'chan not assim'
            linestyle: ''
            marker: 's'
            markersize: '6'

          - type: HorizontalLine
            y: 0
            linewidth: 0.75
            label: ''

        # Contribution to Penalty, 1 cycle, 1 day, 30 days
        # ------------------------------------------------
        - add_xlabel: 'Level'
          add_ylabel: 'Contribution to Penalty'
          add_legend:
            loc: 'upper left'
          set_xticks: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]
          add_grid:
            axis: 'both'
            linestyle: 'dotted'
            linewidth: 0.25
            color: 'black'
          add_title: 
            label: "Contribution to Penalty\n {{ PDATE | to_YMDH }}"
            loc: 'Left'
          layers:

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::cpen_1c
            color: 'blue'
            label: '1 cycle'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::cpen_1d
            color: 'green'
            label: '1 day'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::level
            y:
              variable: summary::GsiIeee::cpen_30d
            color: 'red'
            label: '30 days'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::assim
            y: 
              variable: summary::GsiIeee::yaxis_np5
            color: 'green'
            label: 'chan assim'
            linestyle: ''
            marker: 's'
            markersize: '6'

          - type: LinePlot
            x:
              variable: summary::GsiIeee::nassim
            y: 
              variable: summary::GsiIeee::yaxis_np5
            color: 'red'
            label: 'chan not assim'
            linestyle: ''
            marker: 's'
            markersize: '6'
